/* Haukr1.hal */external inner function string 60 UserDefined(string,string);external inner function Boolean CheckOffLineRecords(Boolean);external inner function Boolean TouchScreenLook();external inner function string 60 TileUserDefined(string,Integer,var Integer);function boolean CheckMyMachine()begin record IVCashVc Cashr;  record LocalMachineBlock LMb;  integer wn;  boolean res;    res = false;  wn = curwindow;  getWindowRecord(wn,Cashr);  blockload(LMb);  //StopAlert(Cashr.LocalMachineCode);  if ((Cashr.LocalMachineCode == LMb.LocalMachineCode) or blank(Cashr.LocalMachineCode)) then begin   res = true;  end;  CheckMyMachine = res;return;end;event DefineWindowsbegin  real h,h1,hl,h2,h3,h4,h5,h6,h7,hs,v,vm,l,vs,f,v2,t;  string 255 label;  integer flagtr;        SetLangMode(LangUkrainian,"UKR",0);      WindowBegin("Визначте звіт по інкасації",CashupVClass,CGMnt,RcType);  SetWRect(20,80,400,350);  vs = 20; h=120; h2=250;    CheckBox(h-50,v=26,0,"Чи була винесена готівка з каси та закрита сесія",flags[5]);  EditFieldTL(h,v=56,100,"до дати",M4Date,Normal,0,d1,false,PasteCurDate);  EditFieldTL(h,v+=20,40,"час",M4STime,Normal,0,sStartTime,false,PasteCurTime);  EditFieldTL(h,v+=20, 60,"Машина",M4Str,ViewOnly,30,f1,false,0);  EditFieldTL(h,v+=20, 60,"Скринька",M4UStr,ViewOnly,5,f4,false,DrawerSClass);  v = v + 40; vm = v;    ButtonFrame(h,v+=40,170,2,"Вибір");  CheckBox(h,v,0,"готівка ресторану",flags[1]);  CheckBox(h,v+=16,0,"готівка з ЕККА",flags[2]);  CheckBox(h,v+=16,0,"готівка з розрах. з кл.",flags[3]);  EndWindow;WindowBegin("Накладна ЕККА",IVCashDClass,CGview,-);  SetWRect(20,80,620,400);  Sizeable(-1,-1,0,0);  DynamicWindow;  UseView(IVCashVc);  if (CheckMyMachine) then begin  if (CheckOffLineRecords(false)) then begin  StaticText(50,20,"Є несинхронізовані накладні",false);  StaticText(50,40,"Щоб створювати нові накладні ЕККА, виберіть",false);  StaticText(50,60,"Синхронізацію офлайн-накладних з вікна накладних, меню Операції",false);  end else begin  ActiveFieldOnNew("Math");  Tile(0,48+24,false,"",CustCode);  EditField(75,vm=(v=6), 82,"Номер",Normal,SerNr,false,TSerSClass);  EditField(75,v+=20,95, "Клієнт",Normal,CustCode,false,CUSClass);  EnterSkip(Math);  EditField(h=216,v=vm,-40,"Назва",Normal,Addr0,false,0);  TileButton(1,"Платіж");  TileButton(2,"Товари");  Tile(1,70,false,"1",CashValue);//PayDeal  vs = 20;h=75;h2=160;h3=310;h4=480;  EditField(h,v=6,80,"Готівкою",Normal,CashValue,true,0);  EnterSkip(PayDeal);  EditField(h3,v,80,"Здача",ViewOnly,RetValue,true,0);  EditField(h4+150,v,70,"Продавець",Normal,SalesMan,false,UserSClass);  v=v+vs;  EditField(h,v,80,"Кр. карткою",Normal,RecValue,true,0);  EditField(h,v+=vs, -20,"Коментар",Normal,InvComment,false,0);  EditField(h3,v-20,80,"Подар. серт.",Normal,RecValue2,true,0);  //if(currentcompany==1 or currentcompany==6)then begin		EditField(h+470,v-20,80,"Приват",Normal,RecValue3,true,0);// Edit ************************** Tuesday, 16 April 2013 11:03:00  //end;  //EditField(h+600,v-20,30,"Сп.",Normal,PayDeal3,false,RestPMSClass);// Edit ************************** Tuesday, 16 April 2013 11:03:00  EnterSkip(Math);   Tile(2,120,true,"2",Math);  CheckBox(30,-21,0,"OK",OKFlag);  EditField(-133,-21,95,"Всього",ViewOnly ,Sum4,true,0);  v = 24;  MatrixBegin(4,v,-50,-29,-,200);  MatTypedRow(stp);  Flip(0);  MatCol(t=1,32,"Товар",0,ArtCode,false,INSClass);  MatCol(t,144,"Кіл.",0,Quant,true,MATVARINSClass);  EnterSkip(ArtCode);  Flip(1);  MatCol(t=1,184,"Найменування",0,Spec,false,0);  MatCol(t,-270,"Серійний №",0,SerialNr,false,SerialNrSClass);  MatCol(t,-175,"Ціна",0,Price,true,0);  MatCol(t,-105,"%",0,vRebate,true,0);  MatCol(t,-70,"Сума",0,Sum,true,0);  InsertRowTest;  DeleteRowTest;  EndMatrix;  v = 18; VTab(-35,v,-16,v+vs,ToolFlip,1,"A");  SpecialMenu("Статус товару",'I',0,"ItemStatusIVCashDsm");  end;   end else begin  	StaticText(100,120,"Ви не можете переглядати чужі накладні ЕККА",false);  end;  EndWindow;  return;end;