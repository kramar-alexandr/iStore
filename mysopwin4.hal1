event DefineWindowsbegin  real h,h1,hl,h2,h3,h4,h5,h6,h7,hs,v,vm,l,vs,f,v2,t,v3;  string 255 label;  integer flagtr;     SetLangMode(LangUkrainian,"UKR",0);     WindowBegin("Накладні ЕККА",IVCashLClass,CGmlist,-);  SetWRect(20,80,600,291);  Sizeable(-1,-1,0,0);  SpawnClass(IVCashDClass);  UseView(IVCashVc);  FormName(PrintIVCashL);  RecordList(4,17,-21,-39);  RlColKey(4,2,"Номер",SerNr,false,SerNr);  RlColKey(71,66,"OK",OKFlag,false,OKFlag);  RlColKey(118,118,"Дата накладної",InvDate,false,InvDate);  RlColKey(225,225,"Клієнт",CustCode,false,CustCode);  RlColKey(295,295,"Назва",Addr0,false,Name); // RlColKey(-115,-60,"Разом",Sum4,true,Sum4);  RlColKey(-25,-25,"Фін-си",NLFlag,true,NLFlag);  RlCol(-1,-1,"",Invalid,true);  SearchField("Пошук");  SpecialMenu("OK",'G',0,"OKIVCashLsm");  SpecialMenu("Синхронізувати базові реєстри та настройки",' ',0,"SynchServToOfflineSettingsm");  SpecialMenu("Синхронізувати офлайн-накладні",' ',0,"SynchOfflineToServsm");  EndWindow;      WindowBegin("Скарги",IssueSClass,CGslist,-);	// S  SetWRect(240,80,600,298);  Sizeable(-1,-1,0,0);  UseView(IssueVc);  //SpawnClass(IssueDClass);  RecordList(4,17,-21,-39);  //RlColKey(4,2,"Код",IssueCode,false,IssueCode);  RlColkey(100,100, "Скарга",IssueName,false,IssueName);  SearchField("Пошук");  EndWindow;    WindowBegin("Скарги",IssueLClass,CGmlist,-);	// L  SetWRect(240,80,600,298);  Sizeable(-1,-1,0,0);  UseView(IssueVc);  SpawnClass(IssueDClass);  RecordList(4,17,-21,-39);  //RlColKey(4,2,"Код",IssueCode,false,IssueCode);  RlColkey(10,100, "Скарга",IssueName,false,IssueName);  SearchField("Пошук");  EndWindow;      WindowBegin("Скарги",IssueDClass,CGview,-);	//D  SetWRect(240,80,400,298);  Sizeable(-1,-1,0,0);  UseView(IssueVc);  vs = 20; h3 = 550;  //EditField(h=90,v=6, 82,"Код",Normal,IssueCode,false,0);  EditField(90,30,-40,"Назва скарги",Normal,IssueName,false,0);  EndWindow;    //********* Дефекти ***********    WindowBegin("Дефекти",DefectSClass,CGslist,-);	// S  SetWRect(240,80,600,298);  Sizeable(-1,-1,0,0);  UseView(DefectVc);  //SpawnClass(IssueDClass);  RecordList(4,17,-21,-39);  //RlColKey(4,2,"Код",IssueCode,false,IssueCode);  RlColkey(8,100, "Дефект",DefectName,false,DefectName);  SearchField("Пошук");  EndWindow;    WindowBegin("Дефект",DefectLClass,CGmlist,-);	// L  SetWRect(240,80,600,298);  Sizeable(-1,-1,0,0);  UseView(DefectVc);  SpawnClass(DefectDClass);  RecordList(4,17,-21,-39);  //RlColKey(4,2,"Код",IssueCode,false,IssueCode);  RlColkey(8,100, "Дефект",DefectName,false,DefectName);  SearchField("Пошук");  EndWindow;      WindowBegin("Дефект",DefectDClass,CGview,-);	//D  SetWRect(240,80,400,298);  Sizeable(-1,-1,0,0);  UseView(DefectVc);  vs = 20; h3 = 550;  //EditField(h=90,v=6, 82,"Код",Normal,IssueCode,false,0);  EditField(90,30,-40,"Назва дефекту",Normal,DefectName,false,0);  EndWindow;    //********* Кінець дефектів *********     WindowBegin("Замовлення на обслуговування",SVODClass,CGview,-);  SetWRect(20,80,600,460);  Sizeable(-1,-1,0,0);  DynamicWindow;  UseView(SVOVc);  ActiveFieldOnNew("CustCode");    FormName(SVOForm);  vs = 20; h3 = 550;  Tile(0,70,false,"",CustCode);  EditField(h=90,v=6, 82,"Номер",Normal,SerNr,false,TSerSClass);  EnterSkip(CustCode);  EditField(h2=240,v,-40,"Власник",Normal,Addr0,false,0);  EditField(h,vm=(v+=vs),82, "Клієнт",Normal,CustCode,false,CUSClass);  EditField(h+190,vm,82, "Прийняв",Normal,CustomField7,false,UserSClass);// Edit ************************** Monday, 31 May 2010 9:22:11 AM  TileButton(1,"Дата");  TileButton(2,"Товари");  TileButton(3,"Валюта");  TileButton(4,"Коментар");  TileButton(5,"Передплата");  TileButton(6,"Доставка");  TileButton(7,"Адреса акту/накл.");  TileButton(8,"Адреса дост.");  TileButton(9,"Діяльності");//  CheckBox(h3=h2,vm,0,"Виконано",DoneMark);  Tile(1,70,false,"1",PayDeal);  EditField(h=90,vm=(v=6), 20,"Умов.спл.",Normal,PayDeal,false,PDSClass);  //EditField(h,v+=vs,130,"Відповід.",Normal,OurContact,false,0);// Edit ************************** Tuesday, 1 June 2010 10:58:20 AM  EditField(h,v+=2*vs,130,"Конт. особа",Normal,CustContact,false,ContactSClass);  EditField(h2=350,v=vm,100,"Дата замовлення",Normal,TransDate,false,PasteCurDate);  EditField(h3,v,70,"Серв. склад",Normal,ServLocation,false,LocationSClass);  EditField(h3+100,v,-20,"",ViewOnly,RegTime,false,0);// Edit ************************** Friday, 17 December 2010 09:39:03  EditField(h2,v+=vs,100,"Дата завершеня ремонту",Normal,PlanShip,false,PasteCurDate);  EditField(h3,v,70,"Дата видачі",Normal,RegDate,false,PasteCurDate);    EditField(h2,v+=vs,-20,"Замов. клієнта №",Normal,CustOrdNr,false,0);  EnterSkip(Math);  Tile(2,120,true,"2",Math);  CheckBox(20,-20,0,"Виконано",DoneMark);  EditField(270,-21,70,"Ціна придбання",ViewOnly ,TotCost,true,0);  EditField(-133,-21,70,"Ціна продажу",ViewOnly ,TotPrice,true,0);  v = 24;  MatrixBegin(3,v,-50,-25,-,200);  MatTypedRow(stp);  Flip(0);  MatCol(t=1,32,"Товар",0,ArtCode,false,INSClass);/*  MatCol(t,94,"Var",0,VARList,true,VARSClass);*/  MatCol(t,94,"Кіл-ть",0,Quant,true,0);  Flip(1);  MatCol(t=1,144,"Сер. №",0,SerialNr,false,SVOSerSClass);  EnterSkip(ItemType);  MatCol(t=1,250,"Наймен.",0,Spec,false,0);  EnterSkip(ArtCode);  MatCol(t,-124,"Тип",0,ItemType,false,SetSClass);  MatCol(t,-24,"Номер",0,WOEnum,true,0);  Flip(2);  MatCol(t=1,144,"Станд.пробл.",0,StandProblem,false,StandProblemsSClass);  MatCol(t,-300,"Замов. на роботу",0,WOSerNr,false,0);//  MatCol(t,-190,"Замовлено",0,WOMade,true,0);  MatCol(t,-130,"Акт/накл.",0,Invd,true,0);  MatCol(t,-70,"Дата відв.",0,PlanShiprw,true,0);  Flip(3);  MatCol(t=1,144,"Наймен.",0,Spec,false,0);  MatCol(t,-180,"Вар-ть ремонту",0,Cost,true,0);  MatCol(t,-90,"Макс.вар-ть",0,MaxCost,true,0);  Flip(4);  MatCol(t=1,144,"Наймен.",0,Spec,false,0);  MatCol(t,-254,"Контракт",0,ContractNr,false,COSClass);  MatCol(t,-194,"Рахунок",0,SalesAcc,false,AccSClass);  MatCol(t,-124,"Об'єкт",0,Objects,false,ObjSClass);  MatCol(t,-24,"ПДВ",0,VATCode,false,VATCodeSClass);  InsertRowTest;  DeleteRowTest;  EndMatrix;  vs = 20;  v = 18; VTab(-35,v,-16,v+vs,ToolFlip,1,"A");  v=v+vs;  VTab(-35,v,-16,v+vs,ToolFlip,2,"B");  v=v+vs;  VTab(-35,v,-16,v+vs,ToolFlip,3,"C");  v=v+vs;  VTab(-35,v,-16,v+vs,ToolFlip,4,"D");  Tile(3,70,false,"3",FrRate);  vs = 20;  EditField(h=110,v=6,50,"Валюта",Normal,CurncyCode,false,CurncyCodeSClass);  EditField(h2=295,v,50,"Курс",Normal,FrRate,true,0);  EditField(h3=360,v,50,":",Normal,ToRateB1,true,0);  StaticText(h3+60,v+12,"Осн.вал.1",false);  EditField(h,v+=vs,50,"Осн.вал.1",Normal,BaseRate1,true,0);  EditField(h3,v,50,":",Normal,ToRateB2,true,0);  StaticText(h3+60,v+12,"Осн.вал.2",false);  EditField(h,v+=vs,50,"Осн.вал.2",Normal,BaseRate2,true,0);  Tile(4,300,false,"4",Comment1); vs = 20;   //------------------------------------------------------------------------------------------------------------	 	EditField(h=100,v=6,200,"Власник",Normal,Vlastnik,false,0); 	EditField(h,v+=vs,-20,"Прийнято від",Normal,Priynato,false,0);		EditField(h,v+=vs,-20,"Контактна інф.",Normal,Kontinfo1,false,0);		EditField(h,v+=vs,-20,"e-mail",Normal,Kontinfo2,false,0);		EditField(h,v+=vs,-20,"Адреса клієнта",Normal,Kontinfo3,false,0);  v=v+10;  EditField(h,v+=vs,-100,"Скарги власн.",Normal,Comment1,false,IssueSClass);  EditField(h,v+=vs,-100,"",Normal,Comment2,false,IssueSClass);  v=v+10;  EditField(h,v+=vs,-100,"Наявні деф.",Normal,Comment3,false,DefectSClass);  EditField(h,v+=vs,-100,"",Normal,Comment4,false,DefectSClass);  v=v+10;  StaticText(h,v+=vs,"Комплектність",true);  EditField(h,v+=vs,-20,"Батарея:",Normal,Batary,false,0);  EditField(h,v+=vs,-20,"Зар. пристрій:",Normal,Zaryadka,false,0);  EditField(h,v+=vs,-20,"Інше:",Normal,Inshe,false,0);  v=v+10;  EditField(h,v+=vs,50,"Виробник",Normal,Region,false,ITSClass);  EditField(h+=120,v,50,"Гарантія",Normal,Garanty,false,0);  EditField(h+=120,v,100,"Гарант. №",Normal,GarNo,false,0);  EditField(h+=220,v,100,"Гарант. від дати",Normal,GarDate,false,PasteCurDate);  v=v+10;  EditField(h=100,v+=vs,-20,"Кінцевий прод.",Normal,CustomField1,false,0);  EditField(h,v+=vs,50,"Передпр. підг.",Normal,CustomField2,false,0);  EditField(h+115,v,50,"Бух. док.",Normal,CustomField6,false,0);    Tile(5,90,false,"5",ShipDeal); vs = 20;  EditField(h=100,v=6,100,"Дата передплати",Normal,CustomField3,false,PasteCurDate);  EditField(h,v+=vs,100,"№ квитанциї",Normal,CustomField4,false,0);  EditField(h,v+=vs,100,"Сума",Normal,CustomField5,false,0);      //------------------------------------------------------------------------------------------------------------  Tile(6,90,false,"6",ShipDeal); vs = 20;  EditField(h=90,v=6,60,"Умова відв.",Normal,ShipDeal,false,ShipDealSClass);  EditField(h2=270,v,60,"Спосіб відвант.",Normal,ShipMode,false,DMSClass);  EditField(h3=500,v,60,"Вид замовлення",Normal,OrderClass,false,OrderClassSClass);  EditField(h,v+=vs,50,"Мова",Normal,LangCode,false,LangSClass);//  EditField(h2,v,100,"Location",Normal,Location,false,LocationSClass);//  EditField(h,v+=vs,50,"Проект",Normal,PRCode,false,PRSClass);  EditField(h2,v,150,"Факторинг",Normal,InvoiceToCode,false,CUSClass);  EditField(h3=500,v,60,"Продавець",Normal,SalesMan,false,UserSClass);  EditField(h,v+=vs,100,"ІПН",Normal,VATNr,false,0);  EditField(h2,v,150,"Об'єкт",Normal,Objects,false,ObjSClass);  EditField(h3,v,  100,"Філія",Normal,BranchID,false,AllCUSClass);  EditField(h,v+=vs,70,"Прейскурант",Normal,PriceList,false,PLDefSClass);  EditField(h2,v,65,"Серв. склад",Normal,ServLocation,false,LocationSClass);  Tile(7,220,false,"7",Addr1); vs = 20;  EditField(h=90,v=6,-20,"Отримувач",Normal,Addr1,false,0);  EditField(h,v+=vs,-20,"Адресу",Normal,Addr2,false,0);  EditField(h,v+=vs,-20,"",Normal,Addr3,false,0);  EditField(h,v+=vs,-20,"",Normal,InvAddr3,false,0);  EditField(h,v+=vs,-20,"",Normal,InvAddr4,false,0);  EditField(h,vm=(v+=vs),150,"Телефон",Normal,Phone,false,0);  EditField(h,v+=vs,150,"Факс",Normal,Fax,false,0);  ButtonFrame(h2=310,v=vm+vs,140,5,"ПДВ");  RadioButton(h2,v,0,0,"місцевий",ExportFlag);  RadioButton(h2,v+=16,1,0,"в межах ЄС",ExportFlag);  RadioButton(h2,v+=16,3,0,"в межах ЄС (ПДВ)",ExportFlag);  RadioButton(h2,v+=16,2,0,"за межами ЄС",ExportFlag);  RadioButton(h2,v+=16,4,0,"за межами ЄС (ПДВ)",ExportFlag);  Tile(8,150,false,"8",ShipAddr0); vs = 20;  EditField(h=90,v=6,-20,"Відвант. на",Normal,ShipAddr0,false,0);  EditField(h,v+=vs,-20,"адресу",Normal,ShipAddr1,false,0);  EditField(h,v+=vs,-20,"",Normal,ShipAddr2,false,0);  EditField(h,v+=vs,-20,"",Normal,ShipAddr3,false,0);  EditField(h,v+=vs,-20,"",Normal,DelAddr3,false,0);  EditField(h,v+=vs,-20,"",Normal,DelAddr4,false,0);  EditField(h,v+=vs,80,"адресу",Normal,DelAddrCode,false,DelAddrSClass);  EnterSkip(PayDeal);  Tile(9,350,false,"9",-);  RecordList2(4,20,-21,-39,"ActVc");  RlColKey(4,4,"№",SerNr,false,ActSVOSerNr);  RlCol(80,80,"Дата",TransDate,false);  RlCol(160,160,"Час",StartTime,false);  RlCol(230,230,"Витр. час",CostTime,false);  RlCol(300,300,"Коментар",Comment,false);  /*SpecialMenu("Статус замовлення на обсл.",'r',0,"SVOStaDsm");  SpecialMenu("Статус клієнта",'e',1,"SVOCustStatDsm");  SpecialMenu("Пошук товару",'f',2,"ItemSearchDsm");  SpecialMenu("Створити діяльність",'c',3,"ActFromSVODsm");  SpecialMenu("Створити замовлення на роботу",' ',4,"WorkOrderSVODsm");  SpecialMenu("Створити зап. опер. по замовленню",' ',5,"SVGMFromSVODsm");  SpecialMenu("Створити план робіт",' ',6,"WorkSheetSVODsm");  SpecialMenu("Виписати акт/накл. клієнту",'F',7,"IVFromSVODsm");  SpecialMenu("Створити отримання товарів",' ',8,"OffHireFromSVODsm");  SpecialMenu("Створити видачу товарів",' ',0,"DispatchFromSVODsm");*/	SpecialMenu("Рахунок клієнту",' ',0,"ORFromSVODsm");// Edit ************************** Monday, 7 June 2010 1:35:53 PM  /*SpecialMenu("Виплата",' ',0,"MyPPFromSVODsm");  SpecialMenu("Авансовий звіт",' ',0,"MyExpFromSVODsm");  SpecialMenu("Платежі",' ',0,"MyIPFromSVODsm");  if(CurrentCompany==1) then begin    SpecialMenu("Перенести в Computec",' ',0,"MyImportSVOToCompDsm");  end;*/  EndWindow;    return;end;